// =============================
// Prisma Schema for Benefits Platform (HIPAA/PII/PHI compliant)
// Fields marked with @encrypted require field-level encryption
// =============================

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Employee {
  id          String       @id @default(uuid())
  firstName   String
  lastName    String
  email       String       @unique
  ssn         String // @encrypted (PII)
  dob         DateTime // @encrypted (PII)
  address     String // @encrypted (PII)
  phone       String // @encrypted (PII)
  dependents  Dependent[]
  enrollments Enrollment[]
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
}

model Dependent {
  id           String   @id @default(uuid())
  employee     Employee @relation(fields: [employeeId], references: [id])
  employeeId   String
  firstName    String
  lastName     String
  dob          DateTime // @encrypted (PII)
  relationship String
  ssn          String // @encrypted (PII)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

model Plan {
  id          String       @id @default(uuid())
  name        String
  type        String
  tier        String
  description String
  enrollments Enrollment[]
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
}

model Enrollment {
  id           String   @id @default(uuid())
  employee     Employee @relation(fields: [employeeId], references: [id])
  employeeId   String
  plan         Plan     @relation(fields: [planId], references: [id])
  planId       String
  coverage     String
  status       String
  confirmation String // @encrypted (PHI)
  submittedAt  DateTime
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

// Add more models as needed (e.g., Claims, AuditLog, etc.)
